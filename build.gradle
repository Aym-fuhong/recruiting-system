subprojects {
  apply plugin: 'java'

  repositories {
      jcenter()
  }
}

allprojects { apply plugin: "idea" }

task(startServer) {
    doFirst {
        println "Starting jetty"
        project(':api').jettyRun.daemon = true
        project(':api').jettyRun.execute()
        println "Jetty started"

        println "Starting recover"
        project(':api').flywayMigrate.execute()
        project(':api').DBRecovery.execute()

        println "Server started"

        println "Date recovered"
        project(':app').startNodemon.execute()
    }

    doLast {
        project(':api').jettyStop.execute()
        println "Server stoped"
    }
}